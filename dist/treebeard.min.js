!function(t,e){"use strict";"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Treebeard=e()}(this,function(){"use strict";function t(){for(var t=0;t<arguments.length;t++)console.log("==",arguments[t])}function e(){return c+=1}function o(t,e){return"number"===e?function(t,e){return t-e}:function(e,o){var n=e.data[t].toLowerCase().replace(/\s+/g," "),i=o.data[t].toLowerCase().replace(/\s+/g," ");return i>n?-1:n>i?1:0}}function n(t,e){return"number"===e?function(t,e){return e-t}:function(e,o){var n=e.data[t].toLowerCase().replace(/\s/g,""),i=o.data[t].toLowerCase().replace(/\s/g,"");return n>i?-1:i>n?1:0}}function i(t,e,o){var n;for(n=0;n<t.length;n++)if(t[n]&&t[n].hasOwnProperty(e)&&arguments.length>2&&t[n][e]===o)return t.splice(n,1),!0;return!1}var s,r,a,l={},d={},c=-1;r=function(t,e,o,n){this.column=o||null,this.type=e||"info",this.message=t||"Hello",this.on=!1,this.timeout=n||3e3,this.css="",this.toggle=function(){this.on=!this.on},this.show=function(){this.on=!0;var t=this;t.timeout&&setTimeout(function(){t.hide()},t.timeout),m.redraw(!0)},this.hide=function(){this.on=!1,m.redraw(!0)},this.update=function(t,e,o,n,i){this.type=e||this.type,this.column=o||this.column,this.timeout=n||this.timeout,this.message=t,this.css=i||"",this.show(!0)},this.selfDestruct=function(t,e,o){this.on=!1,this.on=!0;var n=this,i=o||3e3;setTimeout(function(){n.hide(),e.removeSelf(),t.redraw()},i)}},a=function(){var t=$("#tb-tbody"),e=this;this.on=!1,this.timeout=!1,this.css="",this.content=null,this.actions=null,this.height=t.height(),this.width=t.width(),this.dismiss=function(){this.on=!1,m.redraw(!0)},this.show=function(){this.on=!0,e.timeout&&setTimeout(function(){e.dismiss()},e.timeout),m.redraw(!0)},this.toggle=function(){this.on=!this.on,m.redraw(!0)},this.update=function(t,o){e.updateSize(),t&&(this.content=t),o&&(this.actions=o),this.on=!0,m.redraw(!0)},this.updateSize=function(){this.height=t.height(),this.width=t.width(),m.redraw(!0)},$(window).resize(function(){e.updateSize()})},s=function(t){void 0===t?(this.data={},this.kind="folder",this.open=!0):(this.data=t,this.kind=t.kind||"item",this.open=t.open),"folder"===this.kind&&(this.load=!1),this.id=e(),this.depth=0,this.children=[],this.parentID=null,this.notify=new r},s.prototype.add=function(t,e){return t.parentID=this.id,t.depth=this.depth+1,t.open=!1,t.load=!1,t.depth>1&&0===t.children.length&&(t.open=!1),e?this.children.unshift(t):this.children.push(t),this},s.prototype.move=function(t){var e=l[t],o=this.parentID,n=l[o];return e.add(this),e.redoDepth(),o>-1&&n.removeChild(parseInt(this.id,10)),this},s.prototype.redoDepth=function(){function t(e,o){var n;for(n=0;n<e.length;n++)e[n].depth=o,e[n].children.length>0&&t(e[n].children,o+1)}t(this.children,this.depth+1)},s.prototype.removeSelf=function(){var t=this.parent();return t.removeChild(this.id),this},s.prototype.removeChild=function(t){return i(this.children,"id",t),this},s.prototype.next=function(){var t,e,o;for(e=l[this.parentID],o=0;o<e.children.length;o++)if(e.children[o].id===this.id)return t=e.children[o+1];if(!t)throw new Error("Treebeard Error: Item with ID '"+this.id+"' has no next sibling")},s.prototype.prev=function(){var t,e,o;for(e=l[this.parentID],o=0;o<e.children.length;o++)if(e.children[o].id===this.id)return t=e.children[o-1];if(!t)throw new Error("Treebeard Error: Item with ID '"+this.id+"' has no previous sibling")},s.prototype.child=function(t){var e,o;for(o=0;o<this.children.length;o++)if(this.children[o].id===t)return e=this.children[o];if(!e)throw new Error("Treebeard Error: Parent with ID '"+this.id+"' has no child with ID: "+t)},s.prototype.parent=function(){return l[this.parentID]?l[this.parentID]:void 0},s.prototype.sortChildren=function(t,e,i,s){var r=t.options.resolveRows.call(t,this),a=r[s].data;if(!e)throw new Error("Treebeard Error: To sort children you need to pass direction to Item.sortChildren");this.children.length>0&&("asc"===e&&this.children.sort(o(a,i)),"desc"===e&&this.children.sort(n(a,i)))},s.prototype.isAncestor=function(t){function e(t,o){return console.log("is ancestor",t,o),t.id===o.id?!0:t.parent()?e(t.parent(),o):!1}return t.parent()?e(t.parent(),this):!1},s.prototype.isDescendant=function(t){function e(t,i){for(o=0;o<t.length;o++){if(t[o].id===i.id){n=!0;break}if(t[o].children.length>0)return e(t[o].children,i)}return n}var o,n=!1;return e(t.children,this)},d.controller=function(e){function o(t){$("#tb-tbody").scrollTop(0),h.currentPage(1);var e,o,n=h.options.resolveRows.call(h,t),i=h.filterText().toLowerCase(),s=!1;for(e=0;e<n.length;e++)o=n[e],o.filter&&-1!==t.data[o.data].toLowerCase().indexOf(i)&&(s=!0);return s}function n(){var t;return h.options.paginate?(t=h.options.showTotal*h.options.rowHeight,h.rangeMargin=0):t=h.visibleIndexes.length*h.options.rowHeight,$(".tb-tbody-inner").height(t),t}function i(t){t=t||0;var e,n,i=h.flatData.length,s=0;for(h.visibleIndexes=[],e=0;i>e;e++)n=l[h.flatData[e].id],h.filterOn?o(n)&&(s++,h.visibleIndexes.push(e)):h.flatData[e].show&&(h.visibleIndexes.push(e),s+=1);return h.refreshRange(t),s}function r(){h.dropzone.destroy()}function d(){h.dropzone&&r();var e=$.extend({clickable:!1,counter:0,accept:function(e,o){h.options.addcheck.call(this,h,h.dropzoneItemCache,e)&&$.when(h.options.resolveUploadUrl.call(h,h.dropzoneItemCache)).then(function(e){if(e&&(h.dropzone.options.url=e,h.dropzone.options.counter++,h.dropzone.options.counter<2)){t("counter",h.dropzone.options.counter);var o=h.returnIndex(h.dropzoneItemCache.id);h.dropzoneItemCache.open||h.toggleFolder(o,null)}return e}).then(function(){$.isFunction(h.options.resolveUploadMethod)&&(h.dropzone.options.method=h.options.resolveUploadMethod.call(h,h.dropzoneItemCache))}).done(function(){o()})},drop:function(t){var e=$(t.target).closest(".tb-row").attr("data-id"),o=l[e];h.dropzoneItemCache=o,$.isFunction(h.options.dropzoneEvents.drop)&&h.options.dropzoneEvents.drop.call(this,h,t)},dragstart:function(t){$.isFunction(h.options.dropzoneEvents.dragstart)&&h.options.dropzoneEvents.dragstart.call(this,h,t)},dragend:function(t){$.isFunction(h.options.dropzoneEvents.dragend)&&h.options.dropzoneEvents.dragend.call(this,h,t)},dragenter:function(t){$.isFunction(h.options.dropzoneEvents.dragenter)&&h.options.dropzoneEvents.dragenter.call(this,h,t)},dragover:function(t){$.isFunction(h.options.dropzoneEvents.dragover)&&h.options.dropzoneEvents.dragover.call(this,h,t)},dragleave:function(t){$.isFunction(h.options.dropzoneEvents.dragleave)&&h.options.dropzoneEvents.dragleave.call(this,h,t)},success:function(t,e){$.isFunction(h.options.dropzoneEvents.success)&&h.options.dropzoneEvents.success.call(this,h,t,e),$.isFunction(h.options.onadd)&&h.options.onadd.call(this,h,h.dropzoneItemCache,t,e)},error:function(t,e,o){$.isFunction(h.options.dropzoneEvents.error)&&h.options.dropzoneEvents.error.call(this,h,t,e,o)},uploadprogress:function(t,e,o){$.isFunction(h.options.dropzoneEvents.uploadprogress)&&h.options.dropzoneEvents.uploadprogress.call(this,h,t,e,o)},sending:function(t,e,o){$.isFunction(h.options.dropzoneEvents.sending)&&h.options.dropzoneEvents.sending.call(this,h,t,e,o)},complete:function(t){$.isFunction(h.options.dropzoneEvents.complete)&&h.options.dropzoneEvents.complete.call(this,h,t)},addedfile:function(t){$.isFunction(h.options.dropzoneEvents.addedfile)&&h.options.dropzoneEvents.addedfile.call(this,h,t)}},h.options.dropzone);h.dropzone=new Dropzone("#"+h.options.divID,e)}function c(t){$.isArray(t)?$.when(h.buildTree(t)).then(function(t){return h.treeData=t,l[0]=t,h.flatten(h.treeData.children),t}).done(function(){i(),n()}):m.request({method:"GET",url:t}).then(function(t){h.treeData=h.buildTree(t)}).then(function(){l[0]=h.treeData,h.flatten(h.treeData.children)}).then(function(){i(),n()})}console.log("========",this);var h=this,p={asc:!1,desc:!1,column:""},u=0,f=0;if(m.redraw.strategy("all"),this.modal=new a,this.flatData=[],this.treeData={},this.filterText=m.prop(""),this.showRange=[],this.options=e,this.selected=void 0,this.mouseon=void 0,this.rangeMargin=0,this.visibleIndexes=[],this.visibleTop=void 0,this.currentPage=m.prop(1),this.dropzone=null,this.dropzoneItemCache=void 0,this.filterOn=!1,this.multiselected=[],this.pressedKey=void 0,this.dragOngoing=!1,this.draggedCache=null,this.redraw=function(){h.flatten(h.treeData.children,h.visibleTop)},this.moveOn=function(){var e,o,n,i,s;e={helper:"clone",cursor:"move",containment:".tb-tbody-inner",delay:200,drag:function(e,o){h.options.dragEvents.drag?h.options.dragEvents.drag.call(h,e,o):(t("drag",o),h.draggedCache||(h.draggedCache=$(o.helper).clone()),h.draggedCache.css({height:"25px",width:"400px",background:"white",padding:"0px 10px","box-shadow":"0 0 4px #ccc"}))},create:function(t,e){h.options.dragEvents.create&&h.options.dragEvents.create.call(h,t,e)},start:function(t,e){h.options.dragEvents.start&&h.options.dragEvents.start.call(h,t,e),h.dragOngoing=!0,$(".tb-row").removeClass(h.options.hoverClass+" tb-h-error tb-h-success")},stop:function(t,e){h.options.dragEvents.stop&&h.options.dragEvents.stop.call(h,t,e),h.dragOngoing=!1,$(".tb-row").removeClass(h.options.hoverClass+" tb-h-error tb-h-success")}},o={tolerance:"pointer",activate:function(t,e){h.options.dropEvents.activate&&h.options.dropEvents.activate.call(h,t,e)},create:function(t,e){h.options.dropEvents.create&&h.options.dropEvents.create.call(h,t,e)},deactivate:function(t,e){h.options.dropEvents.deactivate&&h.options.dropEvents.deactivate.call(h,t,e)},drop:function(t,e){h.options.dropEvents.drop&&h.options.dropEvents.drop.call(h,t,e)},out:function(t,e){h.options.dropEvents.out&&h.options.dropEvents.out.call(h,t,e)},over:function(t,e){var o=parseInt($(t.target).closest(".tb-row").attr("data-id")),n=h.flatData[h.showRange[h.showRange.length-1]].id,i=h.flatData[h.showRange[0]].id;if(console.log(o,n),o===n){console.log("======= last");var s=$("#tb-tbody").scrollTop();$("#tb-tbody").scrollTop(s+35)}if(o===i){console.log("======= first");var s=$("#tb-tbody").scrollTop();$("#tb-tbody").scrollTop(s-35)}h.options.dropEvents.over&&h.options.dropEvents.over.call(h,t,e)}},n=$.extend(e,h.options.dragOptions),i=$.extend(o,h.options.dropOptions),s=h.options.moveClass?h.options.moveClass:"td-title",$("."+s).draggable(n),$(".tb-row").droppable(i)},this.deleteNode=function(t,e){var o=l[e],n=$.extend({},o);$.when(h.options.deletecheck.call(h,o)).done(function(o){if(o){var i=l[t];i.removeChild(e),h.flatten(h.treeData.children,h.visibleTop),h.options.ondelete&&h.options.ondelete.call(h,n)}})},this.canMove=function(t,e){return"folder"!==t.kind?!1:t.isDescendant(e)?!1:!0},this.createItem=function(t,e){var o,n=l[e];return $.when(h.options.createcheck.call(h,t,n)).done(function(e){if(!e)throw new Error("Treebeard Error: createcheck function returned false, item not created.");o=new s(t),n.add(o,!0),h.flatten(h.treeData.children,h.visibleTop),h.options.oncreate&&h.options.oncreate.call(h,o,n)}),o},this.find=function(t){return l[t]?l[t]:void 0},this.returnIndex=function(t){var e,o,n=h.flatData.length;for(e=0;n>e;e++)if(o=h.flatData[e],o.id===t)return e;return void 0},this.returnRangeIndex=function(t){var e,o,n=h.showRange.length;for(e=0;n>e;e++)if(o=h.flatData[h.showRange[e]],o.id===t)return e;return void 0},this.filter=function(t){m.withAttr("value",h.filterText)(t);var e=h.filterText().toLowerCase(),o=h.visibleTop;0===e.length?(h.filterOn=!1,i(0),n(),m.redraw(!0),$("#tb-tbody").scrollTop(f),h.options.onfilterreset&&h.options.onfilterreset.call(h,e)):(h.filterOn||(h.filterOn=!0,f=u),h.visibleTop||(o=0),i(o),n(),m.redraw(!0),h.options.onfilter&&h.options.onfilter.call(h,e))},this.updateFolder=function(t,e){if(t){e.children=[];var o,n;for(n=0;n<t.length;n++)o=h.buildTree(t[n],e),e.add(o);return void(e.open=!0)}var i=h.returnIndex(e.id);e.open=!1,e.load=!1,h.toggleFolder(i,null)},this.toggleFolder=function(t,e){if(void 0===t||null===t)return void h.redraw();console.log("Toggled");var o,s,r,a,d,c,p=h.flatData.length,u=l[h.flatData[t].id],f=h.flatData[t],g=!1,v=f.depth,w=f.depth,b=$('.tb-row[data-id="'+f.id+'"]').find(".tb-toggle-icon");m.render(b.get(0),m("i.icon-refresh.icon-spin")),$.when(h.options.resolveLazyloadUrl(h,u)).done(function(y){if(c=y,c&&"folder"===f.row.kind&&u.open===!1&&u.load===!1)u.children=[],m.request({method:"GET",url:c}).then(function(t){if(t){for($.isArray(t)||(t=t.data),s=0;s<t.length;s++)o=h.buildTree(t[s],u),u.add(o);u.open=!0,u.load=!0;var e=h.options.resolveToggle.call(h,u);m.render(b.get(0),e)}else h.options.lazyLoadError.call(h,u)},function(){h.options.lazyLoadError.call(h,u)}).then(function(){h.flatten(h.treeData.children,h.visibleTop),h.options.lazyLoadOnLoad&&h.options.lazyLoadOnLoad.call(h,u)});else{for(r=t+1;p>r&&(a=h.flatData[r],d=l[h.flatData[r].id],!(a.depth<=w));r++)g&&a.depth>v||(a.depth===v&&(g=!1),u.open?a.show=!1:(a.show=!0,d.open||(v=a.depth,g=!0)));u.open=!u.open,i(h.visibleTop),n(),m.redraw(!0);var T=h.options.resolveToggle.call(h,u);m.render(b.get(0),T)}h.moveOn(),h.options.ontogglefolder&&h.options.ontogglefolder.call(h,u,e)})},this.sortToggle=function(t){var e,o=$(t.target),n=o.attr("data-direction"),i=this,s=o.attr("data-sortType"),r=o.parent(),a=0;$(".asc-btn, .desc-btn").addClass("tb-sort-inactive"),p.asc=!1,p.desc=!1,p[n]||(e=function(t){t.map(function(t){t.sortChildren(h,n,s,i),t.children.length>0&&e(t.children),a+=1})},h.treeData.sortChildren(h,n,s,i),e(h.treeData.children),r.children("."+n+"-btn").removeClass("tb-sort-inactive"),p[n]=!0,h.flatten(h.treeData.children,0))},this.refreshRange=function(t){var e,o,n=h.visibleIndexes.length,i=[],s=0;for(h.visibleTop=t,e=t;n>e&&i.length!==h.options.showTotal;e++)o=h.visibleIndexes[e],i.push(o),s+=1;h.showRange=i,m.redraw(!0)},this.toggleScroll=function(){h.options.paginate=!1,$(".tb-paginate").removeClass("active"),$(".tb-scroll").addClass("active"),$("#tb-tbody").scrollTop((h.currentPage()-1)*h.options.showTotal*h.options.rowHeight),n()},this.togglePaginate=function(){var t=h.showRange[0],e=h.visibleIndexes.indexOf(t),o=Math.floor(e/h.options.showTotal),i=o*h.options.showTotal;h.options.paginate=!0,$(".tb-scroll").removeClass("active"),$(".tb-paginate").addClass("active"),h.currentPage(o+1),n(),h.refreshRange(i)},this.pageUp=function(){var t=h.showRange[h.options.showTotal-1],e=h.visibleIndexes.indexOf(t);e>-1&&e+1<h.visibleIndexes.length&&(h.refreshRange(e+1),h.currentPage(h.currentPage()+1))},this.pageDown=function(){var t=h.showRange[0],e=h.visibleIndexes.indexOf(t);e&&e>0&&(h.refreshRange(e-h.options.showTotal),h.currentPage(h.currentPage()-1))},this.goToPage=function(t){if(t&&t>0&&t<=Math.ceil(h.visibleIndexes.length/h.options.showTotal)){var e=h.options.showTotal*(t-1);h.currentPage(t),h.refreshRange(e)}},this.isMultiselected=function(t){var e=!1;return h.multiselected.map(function(o){o.id===t&&(e=!0)}),e},this.removeMultiselected=function(t){return h.multiselected.map(function(e,o,n){e.id===t&&n.splice(o,1)}),!1},this.highlightMultiselect=function(){$("."+h.options.hoverClassMultiselect).removeClass(h.options.hoverClassMultiselect),this.multiselected.map(function(t){$('.tb-row[data-id="'+t.id+'"]').addClass(h.options.hoverClassMultiselect)})},this.handleMultiselect=function(t){var e,o,n,i,s,r=l[t];if(16===h.pressedKey)if(0!==h.multiselected.length||h.selected){if(e=h.returnRangeIndex(h.selected),o=h.returnRangeIndex(t),e>o?(n=o,i=e):(n=e,i=o),e!==o)for(h.multiselected=[],s=n;i+1>s;s++)h.multiselected.push(l[h.flatData[h.showRange[s]].id])}else h.selected=r.id,h.multiselected.push(r);91===h.pressedKey&&(h.isMultiselected(r.id)?h.removeMultiselected(r.id):h.multiselected.push(r)),h.options.onmultiselect&&h.options.onmultiselect.call(h,event,r),h.highlightMultiselect.call(this)},this.clearMultiselect=function(){$("."+h.options.hoverClassMultiselect).removeClass(h.options.hoverClassMultiselect),h.multiselected=[]},this.buildTree=function(t,e){var o,n,i,r,a;if(Array.isArray(t)?(o=new s,n=t):(o=new s(t),n=t.children,o.depth=e.depth+1),n)for(i=n.length,a=0;i>a;a++)r=h.buildTree(n[a],o),o.add(r);return o},this.flatten=function(t,e){h.flatData=[];var o,s=function r(t,s,a){var d,c,p,u=t.length;for(d=0;u>d;d++)o&&t[d].depth<=o&&(s=!0),c=t[d].children,p={id:t[d].id,depth:t[d].depth,row:t[d].data},p.show=s,t[d].children.length>0&&!t[d].open&&(s=!1,(!o||o>t[d].depth)&&(o=t[d].depth)),h.flatData.push(p),c.length>0&&r(c,s,!1),l[t[d].id]=t[d],a&&d===u-1&&(i(e),n(),m.redraw(!0))};return s(t,!0,!0),t},this.init=function(t,e){if(h.options.allowMove&&h.moveOn(),!e){var o=$("#tb-tbody").height();h.options.showTotal=Math.floor(o/h.options.rowHeight),h.options.rowHeight||(h.options.rowHeight=$(".tb-row").height()),$("#tb-tbody").scroll(function(){if(!h.options.paginate){var t,e,o,i,s,r;t=$(this).scrollTop(),e=t-u,e>0&&e<h.options.rowHeight&&$(this).scrollTop(u+h.options.rowHeight),0>e&&e>-h.options.rowHeight&&$(this).scrollTop(u-h.options.rowHeight),o=n(),i=$(this).children(".tb-tbody-inner").outerHeight(),t=$(this).scrollTop(),s=t/i*100,r=Math.round(s/100*h.visibleIndexes.length),h.rangeMargin=Math.round(o*(t/i)),h.refreshRange(r),m.redraw(!0),u=t}}),console.log("Uploads",h.options),h.options.uploads&&d(),$.isFunction(h.options.onload)&&h.options.onload.call(h),h.options.multiselect&&($(window).keydown(function(t){h.pressedKey=t.keyCode,console.log("Pressed Key",h.pressedKey)}),$(window).keyup(function(){h.pressedKey=void 0,console.log("Pressed Key",h.pressedKey)}))}},!h.options.filesData)throw new Error("Treebeard Error: You need to define a data source through 'options.filesData'");c(h.options.filesData)},d.view=function(t){return[m(".gridWrapper",{config:t.init},[m(".tb-table",[function(){return t.options.showFilter||t.options.title?m(".tb-head.clearfix",[m(".tb-head-filter",{style:"width:"+t.options.filterStyle.width+"; float:"+t.options.filterStyle.float},[function(){return t.options.showFilter?m("input.form-control[placeholder='filter'][type='text']",{style:"width:100%;display:inline;",onkeyup:t.filter,value:t.filterText()}):void 0}()])]):void 0}(),m(".tb-row-titles",[t.options.columnTitles.call(t).map(function(e,o){var n,i,s="",r=0===o?"10px":"0";return e.sort&&(n=t.options.sortButtonSelector.up?t.options.sortButtonSelector.up:"i.fa.fa-sort-asc",i=t.options.sortButtonSelector.down?t.options.sortButtonSelector.down:"i.fa.fa-sort-desc",s=[m(n+".tb-sort-inactive.asc-btn.m-r-xs",{onclick:t.sortToggle.bind(o),"data-direction":"asc","data-sortType":e.sortType}),m(i+".tb-sort-inactive.desc-btn",{onclick:t.sortToggle.bind(o),"data-direction":"desc","data-sortType":e.sortType})]),m(".tb-th",{style:"width: "+e.width+"; padding-left:"+r},[m("span.m-r-sm",e.title),s])})]),m("#tb-tbody",[function(){return t.modal.on?m(".tb-modal-shade",{style:"width:"+t.modal.width+"px; position : absolute; height:"+t.modal.height+"px;"},[m(".tb-modal-inner",{"class":t.modal.css},[m(".tb-modal-dismiss",{onclick:function(){t.modal.dismiss()}},[m("i.icon-remove-sign")]),m(".tb-modal-content",t.modal.content),m(".tb-modal-footer",t.modal.actions)])]):void 0}(),m(".tb-tbody-inner",[m("",{style:"margin-top:"+t.rangeMargin+"px"},[t.showRange.map(function(e,o){var n,i=t.options.oddEvenClass.odd,s=t.flatData[e].depth,r=t.flatData[e].id,a=l[r],d=t.flatData[e].row,c=a.css||"",h=t.options.resolveRows.call(t,a);return o%2===0&&(i=t.options.oddEvenClass.even),n=t.filterOn?20:20*(s-1),a.notify.on&&!a.notify.column?m(".tb-row",[m(".tb-notify.alert-"+a.notify.type,{"class":a.notify.css},[m("span",a.notify.message)])]):m(".tb-row",{key:r,"class":c+" "+i,"data-id":r,"data-level":s,"data-index":e,"data-rIndex":o,style:"height: "+t.options.rowHeight+"px;",onclick:function(e){t.pressedKey&&t.options.multiselect&&t.handleMultiselect(r,o,e),t.pressedKey||(t.selected=r,t.clearMultiselect()),t.options.onselectrow&&t.options.onselectrow.call(t,a,e)},onmouseover:function(e){t.mouseon=r,t.options.hoverClass&&!t.dragOngoing&&($(".tb-row").removeClass(t.options.hoverClass),$(this).addClass(t.options.hoverClass)),t.options.onmouseoverrow&&t.options.onmouseoverrow.call(t,a,e)}},[h.map(function(o,i){var s,l,c=t.options.columnTitles.call(t)[i],h=o.css?o.css:"";return s=m(".tb-td.tb-col-"+i,{"class":o.css,style:"width:"+c.width},[m("span",d[o.data])]),a.notify.on&&a.notify.column===i?m(".tb-td.tb-col-"+i,{style:"width:"+c.width},[m(".tb-notify.alert-"+a.notify.type,{"class":a.notify.css},[m("span",a.notify.message)])]):(o.folderIcons&&(l=o.custom?m("span.title-text",o.custom.call(t,a,o)):m("span.title-text",d[o.data]+" "),s=m(".tb-td.td-title.tb-col-"+i,{"data-id":r,"class":h,style:"padding-left: "+n+"px; width:"+c.width},[m("span.tb-td-first",function(){var o=[{id:1,css:"tb-expand-icon-holder",resolve:t.options.resolveIcon.call(t,a)},{id:2,css:"tb-toggle-icon",resolve:t.options.resolveToggle.call(t,a)}];return t.filterOn?m("span."+o[0].css,{key:o[0].id},o[0].resolve):[m("span."+o[1].css,{key:o[1].id,onclick:function(o){t.options.togglecheck.call(t,a)&&t.toggleFolder(e,o)}},o[1].resolve),m("span."+o[0].css,{key:o[0].id},o[0].resolve)]}()),l])),!o.folderIcons&&o.custom&&(s=m(".tb-td.tb-col-"+i,{"class":h,style:"width:"+c.width},[o.custom.call(t,a,o)])),s)})])})])])]),function(){return t.options.paginate||t.options.paginateToggle?m(".tb-footer",[m(".row",[m(".col-xs-4",function(){if(t.options.paginateToggle){var e="",o="";return t.options.paginate?o="active":e="active",m(".btn-group.padder-10",[m("button.btn.btn-default.btn-sm.tb-scroll",{onclick:t.toggleScroll,"class":e},"Scroll"),m("button.btn.btn-default.btn-sm.tb-paginate",{onclick:t.togglePaginate,"class":o},"Paginate")])}}()),m(".col-xs-8",[m(".padder-10",[function(){if(t.options.paginate){var e=t.visibleIndexes.length,o=Math.ceil(e/t.options.showTotal);return t.options.resolvePagination?t.options.resolvePagination.call(t,o,t.currentPage()):m(".tb-pagination.pull-right",[m("button.tb-pagination-prev.btn.btn-default.btn-sm.m-r-sm",{onclick:t.pageDown},[m("i.fa.fa-chevron-left")]),m("input.tb-pagination-input.m-r-sm",{type:"text",style:"width: 30px;",onkeyup:function(e){var o=parseInt(e.target.value,10);t.goToPage(o)},value:t.currentPage()}),m("span.tb-pagination-span","/ "+o+" "),m("button.tb-pagination-next.btn.btn-default.btn-sm",{onclick:t.pageUp},[m("i.fa.fa-chevron-right")])])}}()])])])]):void 0}()])])]};var h=function(){this.divID="myGrid",this.filesData="small.json",this.rowHeight=void 0,this.paginate=!1,this.paginateToggle=!1,this.uploads=!1,this.multiselect=!1,this.filterStyle={"float":"right",width:"50%"},this.columnTitles=function(){return[{title:"Title",width:"50%",sortType:"text",sort:!0},{title:"Author",width:"25%",sortType:"text"},{title:"Age",width:"10%",sortType:"number"},{title:"Actions",width:"15%"}]},this.resolveRows=function(){return[{data:"title",folderIcons:!0,filter:!0},{data:"person",filter:!0},{data:"age",filter:!1},{data:"action",sortInclude:!1,custom:function(t){var e=this;return m("button.btn.btn-danger.btn-xs",{onclick:function(o){o.stopPropagation(),e.deleteNode(t.parentID,t.id)}}," X ")}}]},this.hoverClass=void 0,this.hoverClassMultiselect="tb-multiselect",this.showFilter=!0,this.title="Grid Title",this.allowMove=!0,this.moveClass=void 0,this.sortButtonSelector={},this.dragOptions={},this.dropOptions={},this.dragEvents={},this.dropEvents={},this.oddEvenClass={odd:"tb-odd",even:"tb-even"},this.onload=function(){},this.togglecheck=function(){return!0},this.onfilter=function(){},this.onfilterreset=function(){},this.createcheck=function(){return!0},this.oncreate=function(){},this.deletecheck=function(){return!0},this.ondelete=function(){},this.movecheck=function(){return!0},this.onmove=function(){},this.movefail=function(){return!0},this.addcheck=function(){return!0},this.onadd=function(){},this.onselectrow=function(){},this.onmultiselect=function(){},this.onmouseoverrow=function(){},this.ontogglefolder=function(){},this.dropzone={url:"http://www.torrentplease.com/dropzone.php"},this.dropzoneEvents={},this.resolveIcon=function(t){return"folder"===t.kind?t.open?m("i.fa.fa-folder-open-o"," "):m("i.fa.fa-folder-o"," "):t.data.icon?m("i.fa."+t.data.icon," "):m("i.fa.fa-file ")},this.resolveToggle=function(t){var e=m("i.fa.fa-minus-square-o"," "),o=m("i.fa.fa-plus-square-o"," ");return"folder"===t.kind&&t.children.length>0?t.open?e:o:""},this.resolvePagination=function(t,e){return m("span","totalPages: "+t+" currentPage: "+e)},this.resolveUploadUrl=function(){return"/upload"},this.resolveLazyloadUrl=function(){return!1},this.lazyLoadError=function(){},this.lazyLoadOnLoad=function(){}},p=function(t){var e=new h,o=$.extend(e,t),n={};return n.controller=function(){this.tbController=new d.controller(o)},n.view=function(t){return d.view(t.tbController)},m.module(document.getElementById(o.divID),n)};return p});